<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§∏‡§æ‡§Å‡§™-‡§∏‡•Ä‡§¢‡§º‡•Ä ‡§ñ‡•á‡§≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            min-height: 100vh;
            padding: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: auto;
        }
        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            padding: 25px;
            max-width: 1200px;
            width: 100%;
            position: relative;
        }
        .game-header {
            text-align: center;
            margin-bottom: 25px;
        }
        .game-title {
            color: #2c3e50;
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .game-subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 15px;
        }
        .player-setup {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
        }
        .player-count {
            margin-bottom: 15px;
        }
        .player-count label {
            font-weight: bold;
            margin-right: 10px;
            color: #2c3e50;
        }
        .player-count select {
            padding: 8px 15px;
            border: 2px solid #bdc3c7;
            border-radius: 25px;
            font-size: 1em;
            background: white;
        }
        .start-game-btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            margin-left: 15px;
            transition: all 0.3s ease;
        }
        .start-game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }
        .game-area {
            display: none;
        }
        .game-area.active {
            display: block;
        }
        .players-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        .player-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 15px;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            text-align: center;
        }
        .player-card.active {
            border-color: #3498db;
            background: #e3f2fd;
            transform: scale(1.05);
        }
        .player-name {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        .player-position {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        .game-board-container {
            position: relative;
            height: 600px;
            margin-bottom: 25px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            background: #87CEEB;
        }
        .board {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: grid;
            grid-template-columns: repeat(10, 50px);
            grid-template-rows: repeat(10, 50px);
            gap: 2px;
            background: #8B4513;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        .cell {
            background: #f5f5dc;
            border: 2px solid #8B4513;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            font-weight: bold;
            font-size: 12px;
            color: #333;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .cell:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .cell.awareness {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        .cell.support {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        .cell.start {
            background: linear-gradient(135deg, #90EE90, #32CD32);
            color: #006400;
            font-weight: bold;
        }
        .cell.end {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #B8860B;
            font-weight: bold;
        }
      .snake {
    position: absolute;
    z-index: 5;
    pointer-events: none;
}
.snake-image {
    object-fit: contain;
    image-rendering: crisp-edges;
    -webkit-image-rendering: crisp-edges;
    -ms-image-rendering: crisp-edges;
    pointer-events: none;
    transform-origin: 0 50%;
}
snake-body {
            position: absolute;
            background: linear-gradient(45deg, #cc3333, #ff6666);
            border-radius: 15px;
            border: 2px solid #990000;
        }
        .snake-head {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #ff4444, #cc0000);
            border-radius: 50%;
            border: 2px solid #990000;
        }
        .snake-head::before {
            content: 'üëÅÔ∏è';
            position: absolute;
            top: -5px;
            left: 2px;
            font-size: 8px;
        }
        .ladder {
            position: absolute;
            z-index: 4;
            pointer-events: none;
        }
        .ladder-rail {
            background: linear-gradient(to right, #DAA520, #FFD700);
            border: 2px solid #B8860B;
            position: absolute;
        }
        .ladder-rung {
            background: linear-gradient(to bottom, #DAA520, #B8860B);
            border: 1px solid #996600;
            position: absolute;
        }
        .game-piece {
            position: absolute;
            width: 20px;
            height: 25px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            z-index: 10;
            border: 2px solid rgba(255,255,255,0.5);
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            transition: all 0.5s ease;
        }
        .piece-red { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .piece-blue { background: linear-gradient(135deg, #3498db, #2980b9); }
        .piece-green { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .piece-yellow { background: linear-gradient(135deg, #f39c12, #d68910); }
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .dice {
            width: 70px;
            height: 70px;
            background: white;
            border: 3px solid #34495e;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8em;
            font-weight: bold;
            color: #34495e;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .dice:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        .dice.rolling {
            animation: roll 0.8s ease-in-out;
        }
        @keyframes roll {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(90deg); }
            50% { transform: rotate(180deg); }
            75% { transform: rotate(270deg); }
        }
        .roll-btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }
        .roll-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(52, 152, 219, 0.6);
        }
        .roll-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .restart-btn {
            padding: 10px 20px;
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-left: 15px;
            transition: all 0.3s ease;
        }
        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        .game-status {
            text-align: center;
            font-size: 1.2em;
            color: #2c3e50;
            margin-bottom: 15px;
            padding: 12px;
            background: #ecf0f1;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }
        .progress-container {
            margin-bottom: 20px;
            background: #ecf0f1;
            border-radius: 15px;
            padding: 15px;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #bdc3c7;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            color: #2c3e50;
            font-size: 0.9em;
        }
        .message-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 90%;
            z-index: 1000;
            text-align: center;
            display: none;
        }
        .message-popup.show {
            display: block;
            animation: popIn 0.5s ease-out;
        }
        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        .message-popup h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.4em;
        }
        .message-popup p {
            color: #7f8c8d;
            line-height: 1.6;
            margin-bottom: 18px;
        }
        .close-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 18px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .close-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        .overlay.show {
            display: block;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            font-size: 0.9em;
        }
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }
        .ladder-color {
            background: linear-gradient(45deg, #DAA520, #FFD700);
        }
        .snake-color {
            background: linear-gradient(45deg, #cc3333, #ff6666);
        }
        .awareness-color {
            background: #f1c40f;
        }
        .support-color {
            background: #2ecc71;
        }
        .message-popup.positive {
            border-left: 5px solid #27ae60;
        }
        .message-popup.negative {
            border-left: 5px solid #e74c3c;
        }
        .message-popup.positive h3 {
            color: #2980b9;
        }
        .message-popup.negative h3 {
            color: #e74c3c;
        }
        
        /* Snake Animations */
        @keyframes snakePulse {
            0%, 100% { filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.7)); }
            50% { filter: drop-shadow(0 0 20px rgba(255, 0, 0, 1)); }
        }

        @keyframes snakeWarning {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .strategic-snake {
            transition: all 0.3s ease;
        }

        .strategic-snake:hover {
            filter: brightness(1.2) !important;
            transform: scale(1.05) !important;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1 class="game-title">üêçü™ú 3D ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§∏‡§æ‡§Å‡§™-‡§∏‡•Ä‡§¢‡§º‡•Ä</h1>
            <p class="game-subtitle">‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡•á‡§Ç</p>
        </div>
        
        <div class="player-setup" id="playerSetup">
            <div class="player-count">
                <label for="playerCountSelect">‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:</label>
                <select id="playerCountSelect">
                    <option value="2">2 ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä</option>
                    <option value="3">3 ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä</option>
                    <option value="4">4 ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä</option>
                </select>
                <button class="start-game-btn" onclick="startGame()">‡§ñ‡•á‡§≤ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
            </div>
        </div>
        
        <div class="game-area" id="gameArea">
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                    <div class="progress-text" id="progressText">0%</div>
                </div>
            </div>
            <div class="players-info" id="playersInfo"></div>
            <div class="game-status" id="gameStatus">
                ‡§ñ‡•á‡§≤ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§∏‡§æ ‡§´‡•á‡§Ç‡§ï‡•á‡§Ç!
            </div>
            <div class="game-board-container" id="gameBoardContainer">
                <div class="board" id="gameBoard">
                    <!-- Board cells will be generated by JavaScript -->
                </div>
            </div>
            <div class="controls">
                <div class="dice" id="dice">üé≤</div>
                <button class="roll-btn" id="rollBtn">‡§™‡§æ‡§∏‡§æ ‡§´‡•á‡§Ç‡§ï‡•á‡§Ç</button>
                <button class="restart-btn" onclick="restartGame()">‡§®‡§Ø‡§æ ‡§ñ‡•á‡§≤</button>
            </div>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color ladder-color"></div>
                    <span>‡§∏‡•Ä‡§¢‡§º‡•Ä</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color snake-color"></div>
                    <span>‡§∏‡§æ‡§Å‡§™</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color awareness-color"></div>
                    <span>‡§ú‡§æ‡§ó‡§∞‡•Ç‡§ï‡§§‡§æ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color support-color"></div>
                    <span>‡§∏‡§π‡§æ‡§Ø‡§§‡§æ</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="overlay" id="overlay"></div>
    <div class="message-popup" id="messagePopup">
        <h3 id="popupTitle"></h3>
        <p id="popupMessage"></p>
        <button class="close-btn" onclick="closePopup()">‡§∏‡§Æ‡§ù ‡§ó‡§Ø‡§æ</button>
    </div>
    
    <script>
        // Game data from your original code
        const awarenessMessages = {
            2: "‡§®‡§∂‡§æ ‡§õ‡•ã‡§°‡§º‡•ã, ‡§ú‡§º‡§ø‡§Ç‡§¶‡§ó‡•Ä ‡§∏‡•á ‡§®‡§æ‡§§‡§æ ‡§ú‡•ã‡§°‡§º‡•ã‡•§",
            9: "‡§ú‡•ã ‡§®‡§∂‡•á ‡§∏‡•á ‡§≤‡§°‡§º‡•á, ‡§µ‡•ã ‡§∏‡§ö‡•ç‡§ö‡§æ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§π‡•à‡•§",
            18: "‡§®‡§∂‡§æ ‡§õ‡•ã‡§°‡§º‡§ï‡§∞ ‡§ñ‡•á‡§≤‡•ã ‡§ú‡§º‡§ø‡§Ç‡§¶‡§ó‡•Ä ‡§ï‡•Ä ‡§Ö‡§∏‡§≤‡•Ä ‡§≤‡•Ç‡§°‡•ã‡•§",
            24: "‡§ñ‡•Å‡§∂‡§π‡§æ‡§≤ ‡§ú‡•Ä‡§µ‡§® ‡§ï‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞ ‚Äî ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§≠‡§æ‡§∞‡§§‡•§",
            36: "‡§è‡§ï ‡§®‡§∂‡§æ, ‡§∏‡•å ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ‡§è‡§Å‡•§ ‡§á‡§∏‡•á ‡§Ü‡§ú ‡§π‡•Ä ‡§õ‡•ã‡§°‡§º‡•á‡§Ç‡•§",
            45: "‡§Ö‡§ö‡•ç‡§õ‡•á ‡§¶‡•ã‡§∏‡•ç‡§§ ‡§µ‡§π‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§®‡§∂‡•á ‡§∏‡•á ‡§¶‡•Ç‡§∞ ‡§∞‡§ñ‡•á‡§Ç‡•§",
            58: "‡§§‡§æ‡§ï‡§§ ‡§π‡•à ‡§ñ‡•Å‡§¶ ‡§Æ‡•á‡§Ç, ‡§®‡§∂‡•á ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç‡•§",
            63: "‡§∏‡§™‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§â‡§°‡§º‡§æ‡§® ‡§®‡§∂‡§æ ‡§®‡§π‡•Ä‡§Ç, ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡•§",
            77: "‡§ñ‡•á‡§≤, ‡§ï‡§≤‡§æ ‡§î‡§∞ ‡§™‡§¢‡§º‡§æ‡§à ‚Äì ‡§Ø‡§π‡•Ä ‡§π‡•à ‡§Ö‡§∏‡§≤‡•Ä ‡§®‡§∂‡§æ‡•§",
            84: "'‡§®‡§æ' ‡§ï‡§π‡§®‡§æ ‡§∏‡•Ä‡§ñ‡•ã ‚Äî ‡§®‡§∂‡§æ, ‡§¶‡§¨‡§æ‡§µ ‡§î‡§∞ ‡§¨‡•Å‡§∞‡•Ä ‡§∏‡§Ç‡§ó‡§§ ‡§ï‡•ã‡•§"
        };
        
        const supportMessages = {
            5: "Narcotics Control Bureau (NCB) ‚Äî ‡§≠‡§æ‡§∞‡§§ ‡§Æ‡•á‡§Ç ‡§®‡§∂‡•Ä‡§≤‡•Ä ‡§¶‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§µ‡§ø‡§∞‡•Å‡§¶‡•ç‡§ß ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡•§",
            16: "National Drug Dependence Treatment Centre (NDDTC), AIIMS ‚Äî ‡§á‡§≤‡§æ‡§ú ‡§î‡§∞ ‡§™‡•Å‡§®‡§∞‡•ç‡§µ‡§æ‡§∏ ‡§Æ‡•á‡§Ç ‡§Ö‡§ó‡•ç‡§∞‡§£‡•Ä‡•§",
            27: "Ministry of Social Justice and Empowerment ‚Äî ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§Ö‡§≠‡§ø‡§Ø‡§æ‡§® ‡§ï‡•Ä ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡•§",
            33: "‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Ø ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§π‡•á‡§≤‡•ç‡§™‡§≤‡§æ‡§á‡§® 14446 ‚Äî ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç‡•§",
            47: "State Anti-Narcotics Task Forces ‚Äî ‡§π‡§∞ ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡•á‡§Ç ‡§®‡§∂‡•á ‡§ï‡•á ‡§ñ‡§ø‡§≤‡§æ‡§´ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§¨‡§≤ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§∞‡§§ ‡§π‡•à‡§Ç‡•§",
            52: "‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Ø ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§Æ‡§ø‡§∂‡§® (NHM) ‚Äî ‡§Æ‡§æ‡§®‡§∏‡§ø‡§ï ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§î‡§∞ ‡§™‡•Å‡§®‡§∞‡•ç‡§µ‡§æ‡§∏ ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§",
            66: "Nasha Mukt Bharat Abhiyan ‚Äî ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§≠‡§æ‡§∞‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§°‡§º‡•Ä ‡§™‡§π‡§≤‡•§",
            71: "CARA, NGOs ‡§î‡§∞ ‡§∏‡§æ‡§Æ‡•Å‡§¶‡§æ‡§Ø‡§ø‡§ï ‡§∏‡§Æ‡•Ç‡§π ‚Äî ‡§®‡§∂‡§æ ‡§™‡•Ä‡§°‡§º‡§ø‡§§‡•ã‡§Ç ‡§ï‡•ã ‡§™‡•Å‡§®‡§∞‡•ç‡§µ‡§æ‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç‡•§",
            89: "Youth Red Cross & NSS Volunteers ‚Äî ‡§ú‡§æ‡§ó‡§∞‡•Ç‡§ï‡§§‡§æ ‡§î‡§∞ ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§∂‡§ø‡§µ‡§ø‡§∞‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§",
            96: "Police & Excise Departments ‚Äî ‡§®‡§∂‡•á ‡§ï‡•á ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞ ‡§™‡§∞ ‡§∏‡§ñ‡•ç‡§§ ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç‡•§"
        };
        
        const snakes = {
            99: 79, 87: 24, 74: 53, 68: 40, 55: 37, 42: 22, 34: 12, 29: 9, 17: 7
        };
        
        const ladders = {
            4: 14, 11: 32, 23: 44, 38: 59, 49: 67, 65: 85, 72: 91, 81: 98
        };
        
          // Snake Image Mapping with working URLs
     /*   const snakeImageMap = {
  snake1: './snake/SVG/Snake-01.svg',
  snake2: './snake/SVG/Snake-02.svg',
  snake3: './snake/SVG/Snake-03.svg',
  snake4: './snake/SVG/Snake-04.svg',
  snake5: './snake/SVG/Snake-05.svg',
  snake6: './snake/SVG/Snake-06.svg',
  snake7: './snake/SVG/Snake-07.svg',
  snake8: './snake/SVG/Snake-08.svg',
  snake9: './snake/SVG/Snake-09.svg'
}; */  
  const snakeImageMap = {
         snake1: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg",
          snake2: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg",
           snake3: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg",
          snake4: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg",
          snake5: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg",
           snake6: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg",
           snake7: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg",
            snake8: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg",
            snake9: "https://github.com/ramankumarasija/snakes/raw/master/3Dsnakes/3D%20snake%201.jpg"
        }; 

        // STRATEGIC SNAKE ASSIGNMENT based on threat level and visual impact
        const strategicSnakeAssignment = {
            // EXTREME THREATS (90-99) - Most dangerous and visually striking
            99: {
                image: snakeImageMap.snake7,
                info: {
                    title: '‡§∞‡§æ‡§ú‡§æ ‡§ï‡•ã‡§¨‡§∞‡§æ - ‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•ç‡§®‡•á‡§ï üëëüêç',
                    message: '‡§∏‡§¨‡§∏‡•á ‡§ñ‡§§‡§∞‡§®‡§æ‡§ï ‡§∏‡§æ‡§Å‡§™! ‡§®‡§∂‡•á ‡§ï‡•Ä ‡§≤‡§§ ‡§ï‡§æ ‡§∞‡§æ‡§ú‡§æ - ‡§∏‡§¨‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§™‡§π‡•Å‡§Å‡§ö‡§æ‡§§‡§æ ‡§π‡•à‡•§'
                },
                height: 45,
                zIndex: 10
            },
            
            95: {
                image: snakeImageMap.snake4,
                info: {
                    title: '‡§®‡•Ä‡§≤‡§æ ‡§ï‡•ã‡§¨‡§∞‡§æ - ‡§¨‡•ç‡§≤‡•Ç ‡§°‡•á‡§• üíôüêç',
                    message: '‡§´‡§® ‡§´‡•à‡§≤‡§æ‡§ï‡§∞ ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§®‡§∂‡§æ ‡§≠‡•Ä ‡§ê‡§∏‡•á ‡§π‡•Ä ‡§Ö‡§ö‡§æ‡§®‡§ï ‡§ú‡•Ä‡§µ‡§® ‡§™‡§∞ ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§'
                },
                height: 42,
                zIndex: 9
            },
            
            // HIGH THREATS (70-89) - Dangerous and aggressive
            87: {
                image: snakeImageMap.snake2,
                info: {
                    title: '‡§π‡§∞‡§æ ‡§µ‡§æ‡§á‡§™‡§∞ - ‡§ó‡•ç‡§∞‡•Ä‡§® ‡§µ‡•á‡§®‡§Æ üêç‚ò†Ô∏è',
                    message: '‡§Æ‡•Å‡§Ç‡§π ‡§ñ‡•ã‡§≤‡§ï‡§∞ ‡§°‡§∞‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§®‡§∂‡•á ‡§ï‡§æ ‡§ú‡§π‡§∞ ‡§≠‡•Ä ‡§ê‡§∏‡•á ‡§π‡•Ä ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§Ö‡§∏‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§'
                },
                height: 38,
                zIndex: 8
            },
            
            82: {
                image: snakeImageMap.snake6,
                info: {
                    title: '‡§≤‡§æ‡§≤ ‡§ß‡§æ‡§∞‡•Ä‡§¶‡§æ‡§∞ ‡§∏‡§æ‡§Å‡§™ - ‡§∞‡•á‡§° ‡§Ö‡§≤‡§∞‡•ç‡§ü üî¥üêç',
                    message: '‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä ‡§ï‡•á ‡§∞‡§Ç‡§ó ‡§Æ‡•á‡§Ç‡•§ ‡§®‡§∂‡§æ ‡§≠‡•Ä ‡§ñ‡§§‡§∞‡•á ‡§ï‡•Ä ‡§ò‡§Ç‡§ü‡•Ä ‡§π‡•à‡•§'
                },
                height: 36,
                zIndex: 7
            },
            
            74: {
                image: snakeImageMap.snake1,
                info: {
                    title: '‡§ß‡§æ‡§∞‡•Ä‡§¶‡§æ‡§∞ ‡§Ö‡§ú‡§ó‡§∞ - ‡§∏‡•ç‡§ü‡•ç‡§∞‡§æ‡§á‡§™‡•ç‡§° ‡§™‡§æ‡§Ø‡§•‡§® üêç',
                    message: '‡§ß‡•Ä‡§∞‡•á-‡§ß‡•Ä‡§∞‡•á ‡§ú‡§ï‡§°‡§º‡§§‡§æ ‡§π‡•à‡•§ ‡§®‡§∂‡•á ‡§ï‡•Ä ‡§≤‡§§ ‡§≠‡•Ä ‡§ê‡§∏‡•á ‡§π‡•Ä ‡§ß‡•Ä‡§∞‡•á-‡§ß‡•Ä‡§∞‡•á ‡§¨‡§æ‡§Ç‡§ß‡§§‡•Ä ‡§π‡•à‡•§'
                },
                height: 34,
                zIndex: 6
            },
            
            // MEDIUM THREATS (40-69) - Moderately dangerous
            68: {
                image: snakeImageMap.snake5,
                info: {
                    title: '‡§®‡•Ä‡§≤‡§æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§∏‡•ç‡§®‡•á‡§ï - ‡§¨‡•ç‡§≤‡•Ç ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü üî∑üêç',
                    message: '‡§ñ‡•Ç‡§¨‡§∏‡•Ç‡§∞‡§§ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§≤‡•á‡§ï‡§ø‡§® ‡§ñ‡§§‡§∞‡§®‡§æ‡§ï‡•§ ‡§®‡§∂‡§æ ‡§≠‡•Ä ‡§™‡§π‡§≤‡•á ‡§Ü‡§ï‡§∞‡•ç‡§∑‡§ï ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡•§'
                },
                height: 32,
                zIndex: 5
            },
            
            55: {
                image: snakeImageMap.snake3,
                info: {
                    title: '‡§≠‡•Ç‡§∞‡§æ ‡§Ö‡§ú‡§ó‡§∞ - ‡§¨‡•ç‡§∞‡§æ‡§â‡§® ‡§™‡§æ‡§Ø‡§•‡§® ü§éüêç',
                    message: '‡§∂‡§æ‡§Ç‡§§ ‡§¶‡§ø‡§ñ‡§§‡§æ ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® ‡§∂‡§ï‡•ç‡§§‡§ø‡§∂‡§æ‡§≤‡•Ä‡•§ ‡§®‡§∂‡•á ‡§ï‡•Ä ‡§õ‡•Å‡§™‡•Ä ‡§π‡•Å‡§à ‡§§‡§æ‡§ï‡§§‡•§'
                },
                height: 30,
                zIndex: 4
            },
            
            42: {
                image: snakeImageMap.snake9,
                info: {
                    title: '‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡§æ ‡§∏‡§æ‡§Å‡§™ - ‡§Ö‡§∞‡•ç‡§• ‡§∏‡•ç‡§®‡•á‡§ï üåçüêç',
                    message: '‡§ú‡§Æ‡•Ä‡§® ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡§æ ‡§π‡•Å‡§Ü‡•§ ‡§®‡§∂‡§æ ‡§≠‡•Ä ‡§ú‡§°‡§º‡•ã‡§Ç ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§'
                },
                height: 28,
                zIndex: 3
            },
            
            // LOW THREATS (Below 40) - Smaller but still dangerous
            34: {
                image: snakeImageMap.snake8,
                info: {
                    title: '‡§π‡§∞‡§æ ‡§™‡•á‡§°‡§º‡•Ä ‡§∏‡§æ‡§Å‡§™ - ‡§ü‡•ç‡§∞‡•Ä ‡§∏‡•ç‡§®‡•á‡§ï üå≥üêç',
                    message: '‡§õ‡•ã‡§ü‡§æ ‡§≤‡•á‡§ï‡§ø‡§® ‡§ö‡•Å‡§∏‡•ç‡§§‡•§ ‡§®‡§∂‡•á ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§≠‡•Ä ‡§ê‡§∏‡•Ä ‡§π‡•Ä ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§'
                },
                height: 25,
                zIndex: 2
            },
            
            29: {
                image: snakeImageMap.snake5,
                info: {
                    title: '‡§õ‡•ã‡§ü‡§æ ‡§®‡•Ä‡§≤‡§æ ‡§∏‡§æ‡§Å‡§™ - ‡§∏‡•ç‡§Æ‡§æ‡§≤ ‡§¨‡•ç‡§≤‡•Ç üêç',
                    message: '‡§Ü‡§ï‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§õ‡•ã‡§ü‡§æ, ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§¨‡§°‡§º‡§æ‡•§'
                },
                height: 22,
                zIndex: 2
            },
            
            17: {
                image: snakeImageMap.snake8,
                info: {
                    title: '‡§®‡§®‡•ç‡§π‡§æ ‡§∏‡§æ‡§Å‡§™ - ‡§ü‡§æ‡§á‡§®‡•Ä ‡§•‡•ç‡§∞‡•á‡§ü üêç',
                    message: '‡§∏‡§¨‡§∏‡•á ‡§õ‡•ã‡§ü‡§æ ‡§≤‡•á‡§ï‡§ø‡§® ‡§´‡§ø‡§∞ ‡§≠‡•Ä ‡§ñ‡§§‡§∞‡§®‡§æ‡§ï‡•§ ‡§π‡§∞ ‡§®‡§∂‡§æ ‡§®‡•Å‡§ï‡§∏‡§æ‡§®‡§¶‡§æ‡§Ø‡§ï ‡§π‡•à‡•§'
                },
                height: 20,
                zIndex: 1
            }
        };

        // FALLBACK SYSTEM for random assignment if position not predefined
        const fallbackSnakesByDifficulty = {
            extreme: [snakeImageMap.snake7, snakeImageMap.snake4, snakeImageMap.snake2],
            hard: [snakeImageMap.snake1, snakeImageMap.snake6, snakeImageMap.snake5],
            medium: [snakeImageMap.snake3, snakeImageMap.snake9],
            easy: [snakeImageMap.snake8]
        };
        
        // Game state
        let players = [];
        let currentPlayer = 0;
        let gameStarted = false;
        let gameStats = {
            totalMoves: 0,
            snakesHit: 0,
            laddersUsed: 0,
            awarenessMessages: 0,
            supportMessages: 0,
            startTime: null
        };
        
        function createBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            
            // Create cells (100 to 1)
            for (let row = 0; row < 10; row++) {
                for (let col = 0; col < 10; col++) {
                    const cellNumber = getCellNumber(row, col);
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.id = `cell-${cellNumber}`;
                    cell.textContent = cellNumber;
                    
                    // Apply special cell styling
                    if (cellNumber === 1) {
                        cell.className += ' start';
                    } else if (cellNumber === 100) {
                        cell.className += ' end';
                    } else if (awarenessMessages[cellNumber]) {
                        cell.className += ' awareness';
                    } else if (supportMessages[cellNumber]) {
                        cell.className += ' support';
                    }
                    
                    // Add click event for cell information
                    cell.addEventListener('click', () => showCellInfo(cellNumber));
                    
                    board.appendChild(cell);
                }
            }
            
            // Add snakes and ladders
            addSnakesAndLadders();
        }
        
        function getCellNumber(row, col) {
            const isLeftToRight = row % 2 === 0;
            if (isLeftToRight) {
                return 100 - (row * 10) - col;
            } else {
                return 100 - (row * 10) - (9 - col);
            }
        }
        
        function getCellPosition(cellNumber) {
            const row = Math.floor((100 - cellNumber) / 10);
            let col = (100 - cellNumber) % 10;
            const isLeftToRight = row % 2 === 0;
            
            if (!isLeftToRight) {
                col = 9 - col;
            }
            
            return { row, col };
        }
        
        // ENHANCED createSnake function with strategic assignment
       /* function createSnakeWithStrategicAssignment(start, end, board) {
            const startPos = getCellPosition(start);
            const endPos = getCellPosition(end);
            
            const snake = document.createElement('div');
            snake.className = 'snake';
            
            // Calculate snake position and size
            const startX = startPos.col * 52 + 26;
            const startY = startPos.row * 52 + 26;
            const endX = endPos.col * 52 + 26;
            const endY = endPos.row * 52 + 26;
            
            const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
            const angle = Math.atan2(endY - startY, endX - startX) * (180 / Math.PI);
            
            // *** STRATEGIC SNAKE SELECTION ***
            let snakeConfig = strategicSnakeAssignment[start];
            
            // If no predefined assignment, use difficulty-based fallback
            if (!snakeConfig) {
                const difficulty = getSnakeDifficulty(start);
                const availableSnakes = fallbackSnakesByDifficulty[difficulty];
                const randomSnake = availableSnakes[Math.floor(Math.random() * availableSnakes.length)];
                
                snakeConfig = {
                    image: randomSnake,
                    info: getGenericSnakeInfo(start),
                    height: getSnakeHeight(start),
                    zIndex: Math.floor(start / 20) + 1
                };
            }
            
            // Create snake image element
            const snakeImage = document.createElement('img');
            snakeImage.src = snakeConfig.image;
            snakeImage.className = 'snake-image strategic-snake';
            snakeImage.style.width = length + 'px';
            snakeImage.style.height = snakeConfig.height + 'px';
            snakeImage.style.position = 'absolute';
            snakeImage.style.left = startX + 'px';
            snakeImage.style.top = startY + 'px';
            snakeImage.style.transformOrigin = '0 50%';
            snakeImage.style.transform = `rotate(${angle}deg)`;
            snakeImage.style.zIndex = snakeConfig.zIndex;
            snakeImage.style.pointerEvents = 'none';
            snakeImage.style.objectFit = 'fill';
            
            // Add visual effects for higher threat snakes
            if (start >= 90) {
                snakeImage.style.filter = 'drop-shadow(0 0 10px rgba(255, 0, 0, 0.7))';
                snakeImage.style.animation = 'snakePulse 2s infinite';
            } else if (start >= 70) {
                snakeImage.style.filter = 'drop-shadow(0 0 5px rgba(255, 100, 0, 0.5))';
            }
            
            // Error handling with intelligent fallback
            snakeImage.onerror = function() {
                console.warn(`Strategic snake ${snakeConfig.image} failed to load`);
                const difficulty = getSnakeDifficulty(start);
                const fallbackOptions = fallbackSnakesByDifficulty[difficulty];
                
                // Try next option in difficulty category
                for (let option of fallbackOptions) {
                    if (option !== snakeConfig.image) {
                        this.src = option;
                        break;
                    }
                }
            };
            
            snake.appendChild(snakeImage);
            
            // Add click event with strategic snake information
            snake.addEventListener('click', () => {
                showMessage(snakeConfig.info.title, snakeConfig.info.message, 'negative');
                
                // Add special effects for high-threat snakes
                if (start >= 80) {
                    snake.style.animation = 'snakeWarning 1s ease-in-out';
                }
            });
            
            board.appendChild(snake);
        } */
// ENHANCED createSnakeWithStrategicAssignment - Optimized for SVG
function createSnakeWithStrategicAssignment(start, end, board) {
    const startPos = getCellPosition(start);
    const endPos = getCellPosition(end);
    
    const snake = document.createElement('div');
    snake.className = 'snake';
    
    // Calculate snake position and size
    const startX = startPos.col * 52 + 26;
    const startY = startPos.row * 52 + 26;
    const endX = endPos.col * 52 + 26;
    const endY = endPos.row * 52 + 26;
    
    const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
    const angle = Math.atan2(endY - startY, endX - startX) * (180 / Math.PI);
    
    // *** STRATEGIC SNAKE SELECTION ***
    let snakeConfig = strategicSnakeAssignment[start];
    
    // If no predefined assignment, use difficulty-based fallback
    if (!snakeConfig) {
        const difficulty = getSnakeDifficulty(start);
        const availableSnakes = fallbackSnakesByDifficulty[difficulty];
        const randomSnake = availableSnakes[Math.floor(Math.random() * availableSnakes.length)];
        
        snakeConfig = {
            image: randomSnake,
            info: getGenericSnakeInfo(start),
            height: getSnakeHeight(start),
            zIndex: Math.floor(start / 20) + 1
        };
    }
    
    // Create snake image element - OPTIMIZED FOR SVG
    const snakeImage = document.createElement('img');
    snakeImage.src = snakeConfig.image;
    snakeImage.className = 'snake-image strategic-snake';
    
    // *** SVG-OPTIMIZED STYLING ***
    snakeImage.style.width = length + 'px';
    snakeImage.style.height = (snakeConfig.height + 15) + 'px'; // Extra height for SVG clarity
    snakeImage.style.position = 'absolute';
    snakeImage.style.left = startX + 'px';
    snakeImage.style.top = (startY - 7) + 'px'; // Better centering for SVG
    snakeImage.style.transformOrigin = '0 50%';
    snakeImage.style.transform = `rotate(${angle}deg)`;
    snakeImage.style.zIndex = snakeConfig.zIndex;
    snakeImage.style.pointerEvents = 'none';
    
    // SVG-specific optimizations
    snakeImage.style.objectFit = 'contain'; // Better for SVG preservation
    snakeImage.style.imageRendering = 'crisp-edges'; // Sharp SVG rendering
    snakeImage.style.WebkitImageRendering = 'crisp-edges';
    snakeImage.style.msImageRendering = 'crisp-edges';
    
    // Add visual effects for higher threat snakes
    if (start >= 90) {
        snakeImage.style.filter = 'drop-shadow(0 0 15px rgba(255, 0, 0, 0.8)) brightness(1.1)';
        snakeImage.style.animation = 'snakePulse 2s infinite';
    } else if (start >= 70) {
        snakeImage.style.filter = 'drop-shadow(0 0 8px rgba(255, 100, 0, 0.6)) brightness(1.05)';
    } else if (start >= 50) {
        snakeImage.style.filter = 'drop-shadow(0 0 5px rgba(255, 200, 0, 0.4))';
    }
    
    // *** COMPREHENSIVE ERROR HANDLING WITH FORMAT FALLBACKS ***
    snakeImage.onerror = function() {
        console.warn(`SVG snake image ${snakeConfig.image} failed to load`);
        
        // Try all available formats in order of preference
        const baseFileName = snakeConfig.image.split('/').pop().replace('.svg', '');
        const alternatives = [
            // Try different SVG naming patterns first
            snakeConfig.image.replace('Snake-0', 'snake-0'),
            snakeConfig.image.replace('Snake-0', 'Snake_0'),
            snakeConfig.image.replace('./snake/SVG/', './snake/svg/'),
            
            // Fallback to PNG (high quality)
            `./snake/PNG/${baseFileName}.png`,
            `./snake/png/${baseFileName}.png`,
            
            // Fallback to JPG
            `./snake/JPG/${baseFileName}.jpg`,
            `./snake/jpg/${baseFileName}.jpg`,
            
            // Try PSD (though browsers won't load it, for completeness)
            `./snake/PSD/${baseFileName}.psd`
        ];
        
        let alternativeIndex = 0;
        
        const tryAlternative = () => {
            if (alternativeIndex < alternatives.length) {
                const nextSrc = alternatives[alternativeIndex];
                console.log(`Trying alternative: ${nextSrc}`);
                this.src = nextSrc;
                alternativeIndex++;
            } else {
                // Ultimate fallback: Create SVG programmatically
                console.warn('All image formats failed, creating programmatic SVG snake');
                this.style.display = 'none';
                
                const svgSnake = createFallbackSVGSnake(length, snakeConfig.height + 15, angle, start);
                svgSnake.style.position = 'absolute';
                svgSnake.style.left = startX + 'px';
                svgSnake.style.top = (startY - 7) + 'px';
                svgSnake.style.zIndex = snakeConfig.zIndex;
                
                snake.appendChild(svgSnake);
            }
        };
        
        this.onerror = tryAlternative;
        tryAlternative();
    };
    
    // Success callback with performance logging
    snakeImage.onload = function() {
        console.log(`‚úÖ Successfully loaded SVG snake: ${snakeConfig.image}`);
        
        // Optional: Add loading animation completion
        this.style.opacity = '0';
        this.style.transition = 'opacity 0.3s ease-in';
        setTimeout(() => {
            this.style.opacity = '1';
        }, 50);
    };
    
    snake.appendChild(snakeImage);
    
    // Enhanced click event with haptic feedback simulation
    snake.addEventListener('click', () => {
        showMessage(snakeConfig.info.title, snakeConfig.info.message, 'negative');
        
        // Visual feedback for interaction
        snakeImage.style.transform = `rotate(${angle}deg) scale(1.1)`;
        setTimeout(() => {
            snakeImage.style.transform = `rotate(${angle}deg) scale(1)`;
        }, 200);
        
        // Special effects for high-threat snakes
        if (start >= 80) {
            snake.style.animation = 'snakeWarning 1s ease-in-out';
        }
    });
    
    board.appendChild(snake);
}

        // FALLBACK SVG CREATOR - Creates snake programmatically if all images fail
function createFallbackSVGSnake(width, height, angle, threatLevel) {
    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    svg.setAttribute('width', width);
    svg.setAttribute('height', height);
    svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
    svg.style.transformOrigin = '0 50%';
    svg.style.transform = `rotate(${angle}deg)`;
    
    // Create gradient based on threat level
    const gradient = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
    const linearGradient = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
    linearGradient.setAttribute('id', `snakeGradient${threatLevel}`);
    
    const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    
    // Color based on threat level
    if (threatLevel >= 90) {
        stop1.setAttribute('stop-color', '#ff0000');
        stop2.setAttribute('stop-color', '#cc0000');
    } else if (threatLevel >= 70) {
        stop1.setAttribute('stop-color', '#ff6600');
        stop2.setAttribute('stop-color', '#cc3300');
    } else {
        stop1.setAttribute('stop-color', '#ff9900');
        stop2.setAttribute('stop-color', '#cc6600');
    }
    
    stop1.setAttribute('offset', '0%');
    stop2.setAttribute('offset', '100%');
    
    linearGradient.appendChild(stop1);
    linearGradient.appendChild(stop2);
    gradient.appendChild(linearGradient);
    svg.appendChild(gradient);
    
    // Create snake body
    const snakeBody = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
    snakeBody.setAttribute('cx', width / 2);
    snakeBody.setAttribute('cy', height / 2);
    snakeBody.setAttribute('rx', width / 2 - 5);
    snakeBody.setAttribute('ry', height / 2 - 5);
    snakeBody.setAttribute('fill', `url(#snakeGradient${threatLevel})`);
    snakeBody.setAttribute('stroke', '#990000');
    snakeBody.setAttribute('stroke-width', '2');
    
    // Add snake head (circle at the end)
    const snakeHead = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
    snakeHead.setAttribute('cx', width - 15);
    snakeHead.setAttribute('cy', height / 2);
    snakeHead.setAttribute('r', '12');
    snakeHead.setAttribute('fill', '#cc0000');
    snakeHead.setAttribute('stroke', '#990000');
    snakeHead.setAttribute('stroke-width', '2');
    
    // Add eyes
    const eye1 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
    eye1.setAttribute('cx', width - 18);
    eye1.setAttribute('cy', height / 2 - 4);
    eye1.setAttribute('r', '2');
    eye1.setAttribute('fill', 'white');
    
    const eye2 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
    eye2.setAttribute('cx', width - 18);
    eye2.setAttribute('cy', height / 2 + 4);
    eye2.setAttribute('r', '2');
    eye2.setAttribute('fill', 'white');
    
    svg.appendChild(snakeBody);
    svg.appendChild(snakeHead);
    svg.appendChild(eye1);
    svg.appendChild(eye2);
    
    return svg;
}
        function createLadder(start, end, board) {
            const startPos = getCellPosition(start);
            const endPos = getCellPosition(end);
            
            const ladder = document.createElement('div');
            ladder.className = 'ladder';
            
            // Calculate ladder position and size
            const startX = startPos.col * 52 + 26;
            const startY = startPos.row * 52 + 26;
            const endX = endPos.col * 52 + 26;
            const endY = endPos.row * 52 + 26;
            
            const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
            const angle = Math.atan2(endY - startY, endX - startX) * (180 / Math.PI);
            
            // Create ladder rails
            const leftRail = document.createElement('div');
            leftRail.className = 'ladder-rail';
            leftRail.style.width = '4px';
            leftRail.style.height = length + 'px';
            leftRail.style.left = startX - 8 + 'px';
            leftRail.style.top = startY + 'px';
            leftRail.style.transformOrigin = '50% 0%';
            leftRail.style.transform = `rotate(${angle}deg)`;
            
            const rightRail = document.createElement('div');
            rightRail.className = 'ladder-rail';
            rightRail.style.width = '4px';
            rightRail.style.height = length + 'px';
            rightRail.style.left = startX + 8 + 'px';
            rightRail.style.top = startY + 'px';
            rightRail.style.transformOrigin = '50% 0%';
            rightRail.style.transform = `rotate(${angle}deg)`;
            
            ladder.appendChild(leftRail);
            ladder.appendChild(rightRail);
            
            // Create ladder rungs
            const rungCount = Math.max(3, Math.floor(length / 20));
            for (let i = 1; i <= rungCount; i++) {
                const rung = document.createElement('div');
                rung.className = 'ladder-rung';
                rung.style.width = '20px';
                rung.style.height = '3px';
                
                const rungX = startX - 10 + ((endX - startX) * i / (rungCount + 1));
                const rungY = startY + ((endY - startY) * i / (rungCount + 1));
                
                rung.style.left = rungX + 'px';
                rung.style.top = rungY + 'px';
                rung.style.transform = `rotate(${angle}deg)`;
                
                ladder.appendChild(rung);
            }
            
            // Add click event for ladder information
            ladder.addEventListener('click', () => {
                showMessage('‡§∏‡•Ä‡§¢‡§º‡•Ä ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ü™ú', 
                    `‡§Ø‡§π ‡§∏‡•Ä‡§¢‡§º‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ${start} ‡§∏‡•á ${end} ‡§§‡§ï ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§ ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§ï‡•á ‡§∞‡§æ‡§∏‡•ç‡§§‡•á ‡§™‡§∞ ‡§Ø‡§π ‡§è‡§ï ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§ï‡§¶‡§Æ ‡§π‡•à‡•§`, 
                    'positive');
            });
            
            board.appendChild(ladder);
        }
        
        // Helper function for difficulty assessment
        function getSnakeDifficulty(startPosition) {
            if (startPosition >= 90) return 'extreme';
            if (startPosition >= 70) return 'hard';
            if (startPosition >= 40) return 'medium';
            return 'easy';
        }
        
        // Generic snake info for non-predefined positions
        function getGenericSnakeInfo(startPosition) {
            const difficulty = getSnakeDifficulty(startPosition);
            const infoMap = {
                extreme: {
                    title: '‡§Ö‡§§‡§ø ‡§ñ‡§§‡§∞‡§®‡§æ‡§ï ‡§∏‡§æ‡§Å‡§™ ‚ö†Ô∏èüêç',
                    message: '‡§Ø‡§π ‡§¨‡•á‡§π‡§¶ ‡§ñ‡§§‡§∞‡§®‡§æ‡§ï ‡§∏‡§æ‡§Å‡§™ ‡§π‡•à! ‡§®‡§∂‡•á ‡§ï‡•Ä ‡§≤‡§§ ‡§≠‡•Ä ‡§á‡§∏‡•Ä ‡§§‡§∞‡§π ‡§ú‡•Ä‡§µ‡§® ‡§ï‡•ã ‡§¨‡§∞‡•ç‡§¨‡§æ‡§¶ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§'
                },
                hard: {
                    title: '‡§ñ‡§§‡§∞‡§®‡§æ‡§ï ‡§∏‡§æ‡§Å‡§™ üêç‚ö°',
                    message: '‡§ñ‡§§‡§∞‡§®‡§æ‡§ï ‡§∏‡§æ‡§Å‡§™ ‡§∏‡•á ‡§∏‡§æ‡§µ‡§ß‡§æ‡§® ‡§∞‡§π‡•á‡§Ç‡•§ ‡§®‡§∂‡§æ ‡§≠‡•Ä ‡§ê‡§∏‡•á ‡§π‡•Ä ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§™‡§π‡•Å‡§Ç‡§ö‡§æ‡§§‡§æ ‡§π‡•à‡•§'
                },
                medium: {
                    title: '‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡§æ‡§Å‡§™ üêç',
                    message: '‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§∏‡§æ‡§Å‡§™ ‡§≠‡•Ä ‡§ñ‡§§‡§∞‡§®‡§æ‡§ï ‡§π‡•à‡•§ ‡§π‡§∞ ‡§§‡§∞‡§π ‡§ï‡§æ ‡§®‡§∂‡§æ ‡§π‡§æ‡§®‡§ø‡§ï‡§æ‡§∞‡§ï ‡§π‡•à‡•§'
                },
                easy: {
                    title: '‡§õ‡•ã‡§ü‡§æ ‡§∏‡§æ‡§Å‡§™ üêç',
                    message: '‡§õ‡•ã‡§ü‡§æ ‡§π‡•ã ‡§Ø‡§æ ‡§¨‡§°‡§º‡§æ, ‡§π‡§∞ ‡§∏‡§æ‡§Å‡§™ ‡§∏‡•á ‡§¨‡§ö‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§®‡§∂‡§æ ‡§≠‡•Ä ‡§ê‡§∏‡§æ ‡§π‡•Ä ‡§π‡•à‡•§'
                }
            };
            
            return infoMap[difficulty];
        }
        
        function getSnakeHeight(startPosition) {
            if (startPosition >= 90) return 45;
            if (startPosition >= 70) return 38;
            if (startPosition >= 40) return 32;
            return 25;
        }
        
        function addSnakesAndLadders() {
            const board = document.getElementById('gameBoard');
            
            // Add snakes with strategic assignment
            Object.entries(snakes).forEach(([start, end]) => {
                createSnakeWithStrategicAssignment(parseInt(start), parseInt(end), board);
            });
            
            // Add ladders
            Object.entries(ladders).forEach(([start, end]) => {
                createLadder(parseInt(start), parseInt(end), board);
            });
        }
        
        function showCellInfo(cellNumber) {
            if (awarenessMessages[cellNumber]) {
                showMessage('‡§ú‡§æ‡§ó‡§∞‡•Ç‡§ï‡§§‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂ üí°', awarenessMessages[cellNumber], 'positive');
            } else if (supportMessages[cellNumber]) {
                showMessage('‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ü§ù', supportMessages[cellNumber], 'positive');
            } else if (cellNumber === 1) {
                showMessage('‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ üéØ', '‡§Ø‡§π‡§æ‡§Å ‡§∏‡•á ‡§Ü‡§™‡§ï‡•Ä ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§ï‡•Ä ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§§‡•Ä ‡§π‡•à!', 'positive');
            } else if (cellNumber === 100) {
                showMessage('‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø üèÜ', '‡§¨‡§ß‡§æ‡§à ‡§π‡•ã! ‡§Ü‡§™‡§®‡•á ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ú‡•Ä‡§µ‡§® ‡§ï‡§æ ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§π‡§æ‡§∏‡§ø‡§≤ ‡§ï‡§ø‡§Ø‡§æ!', 'positive');
            } else {
                showMessage(`‡§∏‡•ç‡§•‡§ø‡§§‡§ø ${cellNumber}`, '‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§ï‡•Ä ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§Æ‡•á‡§Ç ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡§§‡•á ‡§∞‡§π‡•á‡§Ç!', 'neutral');
            }
        }
        
        function createPlayerTokens() {
            // Remove existing tokens
            document.querySelectorAll('.game-piece').forEach(piece => piece.remove());
            
            const colors = ['red', 'blue', 'green', 'yellow'];
            const startCell = document.getElementById('cell-1');
            
            if (!startCell) return;
            
            const cellRect = startCell.getBoundingClientRect();
            const boardRect = document.getElementById('gameBoard').getBoundingClientRect();
            
            players.forEach((player, index) => {
                const piece = document.createElement('div');
                piece.className = `game-piece piece-${colors[index]}`;
                piece.id = `piece-${index}`;
                
                // Position relative to the board
                const offsetX = (index % 2) * 15 - 7.5;
                const offsetY = Math.floor(index / 2) * 15 - 7.5;
                
                piece.style.left = (cellRect.left - boardRect.left + offsetX) + 'px';
                piece.style.top = (cellRect.top - boardRect.top + offsetY) + 'px';
                
                document.getElementById('gameBoard').appendChild(piece);
            });
        }
        
        function movePlayerToken(playerIndex, targetCell) {
            const piece = document.getElementById(`piece-${playerIndex}`);
            const targetCellElement = document.getElementById(`cell-${targetCell}`);
            
            if (!piece || !targetCellElement) return;
            
            const cellRect = targetCellElement.getBoundingClientRect();
            const boardRect = document.getElementById('gameBoard').getBoundingClientRect();
            
            // Calculate position with offset for multiple players
            const playersOnCell = players.filter(p => p.position === targetCell);
            const indexOnCell = playersOnCell.findIndex(p => p.id === players[playerIndex].id);
            
            const offsetX = (indexOnCell % 2) * 15 - 7.5;
            const offsetY = Math.floor(indexOnCell / 2) * 15 - 7.5;
            
            const newX = cellRect.left - boardRect.left + offsetX;
            const newY = cellRect.top - boardRect.top + offsetY;
            
            // Animate movement
            piece.style.transition = 'all 1s ease-in-out';
            piece.style.left = newX + 'px';
            piece.style.top = newY + 'px';
            piece.style.transform = 'scale(1.2)';
            
            // Reset scale after animation
            setTimeout(() => {
                piece.style.transform = 'scale(1)';
            }, 1000);
        }
        
        function startGame() {
            const playerCount = parseInt(document.getElementById('playerCountSelect').value);
            const playerNames = ['‡§≤‡§æ‡§≤ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä', '‡§®‡•Ä‡§≤‡§æ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä', '‡§π‡§∞‡§æ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä', '‡§™‡•Ä‡§≤‡§æ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä'];
            
            players = [];
            currentPlayer = 0;
            
            // Reset game stats
            gameStats = {
                totalMoves: 0,
                snakesHit: 0,
                laddersUsed: 0,
                awarenessMessages: 0,
                supportMessages: 0,
                startTime: Date.now()
            };
            
            for (let i = 0; i < playerCount; i++) {
                players.push({
                    id: i + 1,
                    name: playerNames[i],
                    position: 1,
                    color: `player-${i + 1}`,
                    moves: 0
                });
            }
            
            document.getElementById('playerSetup').style.display = 'none';
            document.getElementById('gameArea').classList.add('active');
            
            createBoard();
            createPlayerTokens();
            createPlayerInfo();
            updateGameStatus();
            updateProgressBar();
            gameStarted = true;
        }
        
        function restartGame() {
            // Reset game state
            players = [];
            currentPlayer = 0;
            gameStarted = false;
            gameStats = {
                totalMoves: 0,
                snakesHit: 0,
                laddersUsed: 0,
                awarenessMessages: 0,
                supportMessages: 0,
                startTime: null
            };
            
            // Reset progress bar
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressText').textContent = '0%';
            
            // Show setup screen
            document.getElementById('gameArea').classList.remove('active');
            document.getElementById('playerSetup').style.display = 'block';
            
            // Reset dice
            document.getElementById('dice').textContent = 'üé≤';
            document.getElementById('rollBtn').disabled = false;
            
            // Remove any existing summary
            const existingSummary = document.querySelector('.game-summary');
            if (existingSummary) {
                existingSummary.remove();
            }
        }
        
        function createPlayerInfo() {
            const playersInfo = document.getElementById('playersInfo');
            playersInfo.innerHTML = '';
            
            players.forEach((player, index) => {
                const playerCard = document.createElement('div');
                playerCard.className = `player-card ${index === currentPlayer ? 'active' : ''}`;
                playerCard.id = `player-card-${index}`;
                playerCard.innerHTML = `
                    <div class="player-name" style="color: ${getPlayerColor(player.color)}">${player.name}</div>
                    <div class="player-position">‡§∏‡•ç‡§•‡§ø‡§§‡§ø: ${player.position}</div>
                `;
                playersInfo.appendChild(playerCard);
            });
        }
        
        function updatePlayerInfo() {
            players.forEach((player, index) => {
                const card = document.getElementById(`player-card-${index}`);
                if (card) {
                    card.className = `player-card ${index === currentPlayer ? 'active' : ''}`;
                    card.querySelector('.player-position').textContent = `‡§∏‡•ç‡§•‡§ø‡§§‡§ø: ${player.position}`;
                }
            });
        }
        
        function getPlayerColor(colorClass) {
            const colors = {
                'player-1': '#e74c3c',
                'player-2': '#3498db',
                'player-3': '#2ecc71',
                'player-4': '#f39c12'
            };
            return colors[colorClass] || '#2c3e50';
        }
        
        function updateProgressBar() {
            const maxPosition = Math.max(...players.map(p => p.position));
            const progress = (maxPosition / 100) * 100;
            
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = Math.round(progress) + '%';
        }
        
        function showMessage(title, message, type = 'neutral') {
            document.getElementById('popupTitle').textContent = title;
            document.getElementById('popupMessage').textContent = message;
            
            const popup = document.getElementById('messagePopup');
            popup.className = 'message-popup show';
            
            // Add color coding based on message type
            if (type === 'positive') {
                popup.classList.add('positive');
            } else if (type === 'negative') {
                popup.classList.add('negative');
            }
            
            document.getElementById('overlay').classList.add('show');
        }
        
        function closePopup() {
            const popup = document.getElementById('messagePopup');
            popup.classList.remove('show', 'positive', 'negative');
            document.getElementById('overlay').classList.remove('show');
        }
        
        function playSound(type) {
            // Create audio context for sound effects
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Different frequencies for different events
                switch(type) {
                    case 'snake':
                        oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.5);
                        break;
                    case 'ladder':
                        oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.3);
                        break;
                    case 'awareness':
                    case 'support':
                        oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                        break;
                }
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log("Audio not supported:", e);
            }
        }
        
        function rollDice() {
            if (!gameStarted) return;
            
            const dice = document.getElementById('dice');
            const rollBtn = document.getElementById('rollBtn');
            
            rollBtn.disabled = true;
            dice.classList.add('rolling');
            
            let rollCount = 0;
            const rollInterval = setInterval(() => {
                dice.textContent = Math.floor(Math.random() * 6) + 1;
                rollCount++;
                
                if (rollCount > 8) {
                    clearInterval(rollInterval);
                    const finalRoll = Math.floor(Math.random() * 6) + 1;
                    dice.textContent = finalRoll;
                    dice.classList.remove('rolling');
                    
                    setTimeout(() => {
                        movePlayer(finalRoll);
                        rollBtn.disabled = false;
                    }, 500);
                }
            }, 100);
        }
        
        function movePlayer(steps) {
            const player = players[currentPlayer];
            let newPosition = Math.min(player.position + steps, 100);
            
            // Can only win by exact count
            if (player.position + steps > 100) {
                showMessage('‡§¨‡§π‡•Å‡§§ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ!', `${player.name} ‡§ï‡•ã ${100 - player.position} ‡§ï‡•Ä ‡§ú‡§∞‡•Ç‡§∞‡§§ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ${steps} ‡§Ü‡§Ø‡§æ‡•§ ‡§´‡§ø‡§∞ ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç!`, 'neutral');
                nextPlayer(steps);
                return;
            }
            
            player.position = newPosition;
            player.moves++;
            gameStats.totalMoves++;
            
            movePlayerToken(currentPlayer, newPosition);
            updatePlayerInfo();
            updateGameStatus();
            updateProgressBar();
            
            // Check for win condition
            if (player.position === 100) {
                setTimeout(() => {
                    showMessage('‡§¨‡§ß‡§æ‡§à ‡§π‡•ã! üéâ', `${player.name} ‡§®‡•á ‡§ñ‡•á‡§≤ ‡§ú‡•Ä‡§§ ‡§≤‡§ø‡§Ø‡§æ! ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ú‡•Ä‡§µ‡§® ‡§ï‡•Ä ‡§ì‡§∞ ‡§Ø‡§π ‡§è‡§ï ‡§¨‡§°‡§º‡§æ ‡§ï‡§¶‡§Æ ‡§π‡•à‡•§`, 'positive');
                    gameStarted = false;
                    showGameSummary(player);
                }, 1000);
                return;
            }
            
            // Check for snake, ladder, or special cells after a delay
            setTimeout(() => {
                checkSpecialCells(player, steps);
            }, 1000);
        }
        
        function checkSpecialCells(player, steps) {
            if (snakes[player.position]) {
                playSound('snake');
                gameStats.snakesHit++;
                const oldPosition = player.position;
                player.position = snakes[player.position];
                
                movePlayerToken(currentPlayer, player.position);
                showMessage('‡§∏‡§æ‡§Å‡§™! üêç', `‡§ì‡§π ‡§®‡§π‡•Ä‡§Ç! ${player.name} ‡§∏‡§æ‡§Å‡§™ ‡§ï‡•á ‡§Æ‡•Å‡§Å‡§π ‡§Æ‡•á‡§Ç ‡§´‡§Å‡§∏ ‡§ó‡§è ‡§î‡§∞ ${oldPosition} ‡§∏‡•á ${player.position} ‡§™‡§∞ ‡§Ü ‡§ó‡§è‡•§ ‡§®‡§∂‡§æ ‡§≠‡•Ä ‡§ê‡§∏‡•á ‡§π‡•Ä ‡§Ü‡§™‡§ï‡•ã ‡§®‡•Ä‡§ö‡•á ‡§≤‡•á ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§`, 'negative');
                updatePlayerInfo();
                updateProgressBar();
            } else if (ladders[player.position]) {
                playSound('ladder');
                gameStats.laddersUsed++;
                const oldPosition = player.position;
                player.position = ladders[player.position];
                movePlayerToken(currentPlayer, player.position);
                showMessage('‡§∏‡•Ä‡§¢‡§º‡•Ä! ü™ú', `‡§µ‡§æ‡§π! ${player.name} ‡§®‡•á ‡§∏‡•Ä‡§¢‡§º‡•Ä ‡§™‡§ï‡§°‡§º ‡§≤‡•Ä ‡§î‡§∞ ${oldPosition} ‡§∏‡•á ${player.position} ‡§™‡§∞ ‡§ö‡§¢‡§º ‡§ó‡§è‡•§ ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§‡§ø ‡§ï‡•á ‡§∞‡§æ‡§∏‡•ç‡§§‡•á ‡§™‡§∞ ‡§Ø‡§π ‡§è‡§ï ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§ï‡§¶‡§Æ ‡§π‡•à‡•§`, 'positive');
                updatePlayerInfo();
                updateProgressBar();
                
                // Check for win after ladder
                if (player.position === 100) {
                    setTimeout(() => {
                        showMessage('‡§¨‡§ß‡§æ‡§à ‡§π‡•ã! üéâ', `${player.name} ‡§®‡•á ‡§∏‡•Ä‡§¢‡§º‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ñ‡•á‡§≤ ‡§ú‡•Ä‡§§ ‡§≤‡§ø‡§Ø‡§æ! ‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ú‡•Ä‡§µ‡§® ‡§ï‡•Ä ‡§ì‡§∞ ‡§Ø‡§π ‡§è‡§ï ‡§¨‡§°‡§º‡§æ ‡§ï‡§¶‡§Æ ‡§π‡•à‡•§`, 'positive');
                        gameStarted = false;
                        showGameSummary(player);
                    }, 1000);
                    return;
                }
            } else if (awarenessMessages[player.position]) {
                playSound('awareness');
                gameStats.awarenessMessages++;
                showMessage('‡§ú‡§æ‡§ó‡§∞‡•Ç‡§ï‡§§‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂ üí°', awarenessMessages[player.position], 'positive');
            } else if (supportMessages[player.position]) {
                playSound('support');
                gameStats.supportMessages++;
                showMessage('‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ü§ù', supportMessages[player.position], 'positive');
            }
            
            nextPlayer(steps);
        }
        
        function nextPlayer(steps) {
            // Move to next player if not a 6
            if (steps !== 6) {
                currentPlayer = (currentPlayer + 1) % players.length;
                updateGameStatus();
                updatePlayerInfo();
            } else {
                showMessage('‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ö‡§≤‡•á‡§Ç! üé≤', `${players[currentPlayer].name} ‡§ï‡•ã 6 ‡§Ü‡§Ø‡§æ ‡§π‡•à! ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§è‡§ï ‡§î‡§∞ ‡§Æ‡•å‡§ï‡§æ ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à‡•§`, 'positive');
            }
        }
        
        function updateGameStatus() {
            const statusElement = document.getElementById('gameStatus');
            const current = players[currentPlayer];
            statusElement.textContent = `${current.name} ‡§ï‡•Ä ‡§¨‡§æ‡§∞‡•Ä ‡§π‡•à (‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∏‡•ç‡§•‡§ø‡§§‡§ø: ${current.position})`;
        }
        
        function showGameSummary(winner) {
            const gameTime = Math.round((Date.now() - gameStats.startTime) / 1000);
            const minutes = Math.floor(gameTime / 60);
            const seconds = gameTime % 60;
            
            const summaryHTML = `
                <div class="game-summary" style="background: white; border-radius: 15px; padding: 25px; margin: 20px 0; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                    <h2 style="color: #2c3e50; font-size: 1.5em; margin-bottom: 15px; text-align: center;">üéâ ‡§ñ‡•á‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ - ${winner.name} ‡§ï‡•Ä ‡§ú‡•Ä‡§§! üéâ</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #3498db;">${gameTime}</div>
                            <div style="color: #7f8c8d; font-size: 0.9em; margin-top: 5px;">‡§ï‡•Å‡§≤ ‡§∏‡§Æ‡§Ø (‡§∏‡•á‡§ï‡§Ç‡§°)</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #3498db;">${gameStats.totalMoves}</div>
                            <div style="color: #7f8c8d; font-size: 0.9em; margin-top: 5px;">‡§ï‡•Å‡§≤ ‡§ö‡§æ‡§≤‡•á‡§Ç</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #3498db;">${gameStats.snakesHit}</div>
                            <div style="color: #7f8c8d; font-size: 0.9em; margin-top: 5px;">‡§∏‡§æ‡§Å‡§™ ‡§Æ‡§ø‡§≤‡•á</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #3498db;">${gameStats.laddersUsed}</div>
                            <div style="color: #7f8c8d; font-size: 0.9em; margin-top: 5px;">‡§∏‡•Ä‡§¢‡§º‡•Ä ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #3498db;">${gameStats.awarenessMessages}</div>
                            <div style="color: #7f8c8d; font-size: 0.9em; margin-top: 5px;">‡§ú‡§æ‡§ó‡§∞‡•Ç‡§ï‡§§‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #3498db;">${gameStats.supportMessages}</div>
                            <div style="color: #7f8c8d; font-size: 0.9em; margin-top: 5px;">‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <p style="font-size: 1.1em; color: #2c3e50;">
                            ‡§ñ‡•á‡§≤ ‡§ï‡§æ ‡§∏‡§Æ‡§Ø: ${minutes} ‡§Æ‡§ø‡§®‡§ü ${seconds} ‡§∏‡•á‡§ï‡§Ç‡§°<br>
                            ‡§µ‡§ø‡§ú‡•á‡§§‡§æ ‡§ï‡•Ä ‡§ï‡•Å‡§≤ ‡§ö‡§æ‡§≤‡•á‡§Ç: ${winner.moves}<br>
                            <strong style="color: #27ae60;">‡§®‡§∂‡§æ ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§≠‡§æ‡§∞‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡§æ ‡§Ø‡•ã‡§ó‡§¶‡§æ‡§® ‡§∏‡§∞‡§æ‡§π‡§®‡•Ä‡§Ø ‡§π‡•à!</strong>
                        </p>
                    </div>
                </div>
            `;
            
            // Insert summary before controls
            const controls = document.querySelector('.controls');
            controls.insertAdjacentHTML('beforebegin', summaryHTML);
        }
        
        // Event listeners
        document.getElementById('rollBtn').addEventListener('click', rollDice);
        document.getElementById('dice').addEventListener('click', rollDice);
        
        // Close popup on overlay click
        document.getElementById('overlay').addEventListener('click', closePopup);
    </script>
</body>
</html>